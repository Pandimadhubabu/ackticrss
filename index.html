<!DOCTYPE HTML>
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <title>Ack News</title>
    <meta name="viewport" content="initial-scale=1.0, maximum-scale=1.0,user-scalable=no">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <link rel="icon" type="image/png" href="favicon.png">
    <script src="https://code.jquery.com/jquery-1.7.1.min.js"></script>
    <script src="https://acktic.github.io/rss.js"></script>
  </head>
<body>
<style>
	::-webkit-scrollbar {
		display: none;
	}
	div {
		font-family: -apple-system,BlinkMacSystemFont,Segoe UI,Helvetica,Arial,sans-serif,Apple Color Emoji,Segoe UI Emoji;
		font-size: 13px;
		cursor: default;
		border: none;
	}
	.con {
		position: absolute;
		height: 100%;
		width: 99%;
		left: 1px;
		top: 0em;
	}
	.cat {
		display: inline-block;
		padding-bottom: 1.5em;
		padding-top: 1.5em;
		text-align: center;
		font-size: 12px;
		width: 16.3%;
	}
	.out {
		outline: none !important;
		position: absolute;
		overflow: auto;
		bottom: 3em;
		width: 98%;
		left: 4px;
		top: 4em;
	}
	.xml {
		padding-bottom: 3em;
		padding-left: 2px;
		padding-top: 3em;
		width: 98%;
	}
	.bar {
		margin-bottom: 8em;
		margin-top: 6em;
		padding: 6em;
	}
	.toggle {
		position: absolute;
		padding-right: 2em;
		font-size: 16px;
		bottom: -.2em;
		padding: 1em;
		left: 1em;
	}
	.random {
		position: absolute;
		padding-left: 2em;
		font-size: 16px;
		bottom: -.2em;
		padding: 1em;
		right: 1em;
	}
</style>
    <div class="con">
	<div class="tag" style="justify-content: center; display: flex">
		<div id="Local" class="cat" onclick="pop('Local')">Local</div>
		<div id="Entertainment" class="cat" onclick="pop('Entertainment')">Ent</div>
		<div id="Social" class="cat" onclick="pop('Social')">Social</div>
		<div id="Sports" class="cat" onclick="pop('Sports')">Sports</div>
		<div id="Technology" class="cat" onclick="pop('Technology')">Tech</div>
		<div id="World" class="cat" onclick="pop('World')">World</div></div>
	<div class="out"></div>
		<div class="toggle" onclick="app('toggle')"><i class="fa fa-th-large"></i></div>
		<div class="random" onclick="ran(sel)"><i class="fa fa-random"></i></div>
    </div>
<script>
var rss = false;
var dark = true;
var sel = "Local";
jQuery(function($) {
    $(window).load(function() {
	pop(sel)
	if ( location.href.match('\\?dark=0') ) dark = false;
	if ( location.href.match('\\&cat=Local') ) pop("Local");
 	if ( location.href.match('\\&cat=Entertainment') ) pop("Entertainment");
	if ( location.href.match('\\&cat=Social') ) pop("Social");
	if ( location.href.match('\\&cat=Sports') ) pop("Sports");
	if ( location.href.match('\\&cat=Technology') ) pop("Technology");
	if ( location.href.match('\\&cat=World') ) pop("World");
	$(".out").attr('tabindex', -1).focus();
	$(".out").focusout(function(){
		$(".out").attr('tabindex', -1).focus();
	});
	app();
    });
    $(document).one("ready", function() {
   	$('.out').bind('scroll', function(){
		if ($(this).scrollTop() + $(this).innerHeight() >= $(this)[0].scrollHeight ) {
			if (rss == false) {
				pop(sel);
			}
		}
	});
    });
});
	function url(n) { window.open(n); };
	function scr(n) { $(".out").animate({ scrollTop: $(n + ":last").offset().top - $(".out").offset().top + $(".out").scrollTop() }, 1000); }
	function pop(n) {
		sel = n;
		$(".pop, .xml, .bar").remove();
		$(".out").append("<div class='pop' style='margin-top:" + $(".out").height() / 100 * 50 + "px'>");
		scr(".pop");
		$.each(menu, function(i, k) {
			if (n == k.category) {
				$(".out").append("<div id='" + k.name + "' class='xml' onclick='xhr($(this).attr(\"id\"))'>&ensp;&ensp;<i class='fa fa-rss'></i>&ensp;&ensp;<b>" + k.category + "</b>&ensp;" + k.title + "</div>");
			}
		});
		$('.out').append("<div class='bar' onclick='ran(sel)'><div style='text-align:center;width:100%'>&ensp;&ensp;<b>Random " + sel + "</b></div></div>");
		app();
	}
	function xhr(n) {
		$.each(menu, function(i, k) {
			if (n == k.name) {
				get(k.category, k.feed, k.title, k.homepage);
			}
		});
	}
	function ran(n) {
		var obj = [];
		$.each(menu, function(i, k) {
			if (n == k.category) {
				obj.push(menu[i]);
			}
		});
		var n = obj[Math.floor(Math.random()*obj.length)];
		get(n.category, n.feed, n.title, n.homepage);
	}
	function app(n) {
		if (n == "toggle") dark = dark != true;
		if (dark == false) {
			$("body, .con, .cat, .xml").attr("style", "background-color: transparent; color: #000000;");
		}
		else if (dark == true) {
			$("body, .con, .cat, .xml").attr("style", "background-color: #000000; color: #FFFFFF;");
		}
	}
	function get(category, feed, title, homepage) {
		rss = true;
		$(".pop, .bar").remove();
		$(".out").append("<div class='get'><div class='xml'>&ensp;&ensp;It's on the way!&ensp;&ensp;Please be patient.</div></div>")
		scr(".get");
		$.get("https://salty-refuge-64158.herokuapp.com/" + feed)
		.fail(function () {
			rss = false;
			$(".out").append("<div class='get'><div class='xml'><div class='xml'>Oops! Something went wrong!</div></div>");
		 })
		.success(function (data) {
			var entry = $(data).find("entry");
			if (entry.length > 0) {
				var format = "entry"
			}
			else {
				var format = "item"
			}
			$(".out").append("<div class='get'><div class='xml' onclick='url(\"" + homepage + "\")'><i class='fa fa-external-link'></i>&ensp;&ensp;<b>" + category + "</b>&ensp;" + title + "</div>");
			$(data).find(format).each(function (i, k) {
				if (format == "entry") {
					var link = $(this).find("link").attr("href");
				}
				else {
					var link = $(this).find("link").text();
				}
				$(".out").append("<div class='xml' onclick='url(\"" + link + "\")'>&ensp;&ensp;" + $(this).find("title").text() + "</div>");
				if(i >= 24) { return false; }
			});
			rss = false;
			$(".out").append("<div class='xml' onclick='url(\"" + homepage + "\")'><i class='fa fa-external-link'></i>&ensp;&ensp;<b>" + category + "</b>&ensp;" + title + "</div>");
			$('.out').append("<div class='bar' onclick='ran(sel)'><div style='text-align:center;width:100%'>&ensp;&ensp;<b>Random " + sel + "</b></div></div>");
			app();
			scr(".get");
		})
	}
</script>
</body>
</html>
