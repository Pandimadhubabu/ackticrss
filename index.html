<!DOCTYPE HTML>
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta content="text/html;charset=utf-8" http-equiv="Content-Type"><meta content="utf-8" http-equiv="encoding">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0,user-scalable=no">
    <script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
    <link rel="icon" type="image/png" href="favicon/invert.png">
    <script src="https://acktic.github.io/rss.js"></script>
  </head>
<style>
@media screen and (min-width: 960px) {

    html { background-color: #fafafa }

    .wrapper {
	transform: translate(50%,50%);
	border: 1px solid #ddd;
	position: fixed;
	border: none;
	height: 100%;
	bottom: 50%;
	width: 50%;
	right: 50%;
    }

    ::-webkit-scrollbar { width: 5px }

    .invert::-webkit-scrollbar-thumb {background-color: #ddd }

    .invert::-webkit-scrollbar { background-color: #f5f5f5 }

    .invert {
	scrollbar-color: #ddd #f5f5f5;
	scrollbar-width: thin;
    }

    .default::-webkit-scrollbar-thumb { background-color: #0a0a0a }

    .default::-webkit-scrollbar { background-color: #000 }

    .default {
	scrollbar-color: #222 #000;
	scrollbar-width: thin;
    }

}

    div { font-family: -apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Helvetica,Arial,sans-serif }

    .category:hover { color: #ccc !important }

    .set:hover { text-decoration: underline }

    .img { padding-bottom: 1.5em }

    hr { opacity: .2 }

    html, body, .container, .output {
	overflow: hidden;
	height: 100%;
	right: 0em;
	left: 0em;
	top: 0em;
    }
    .arm {
	transform: translate(50%,50%);
	position: absolute;
	height: 50%;
	right: 50%;
	top: 0;
    }

    .ico {
	transform: translateX(-50%);
	position: absolute;
	text-align: center;
	bottom: 0em;
	left: 50%;
    }
    .fav {
	border-radius: 24px;
	position: relative;
	cursor: pointer;
	height: 32px;
	width: 32px;
	top: 75px;
    }
    #inv {
	-moz-box-shadow: 1p 1px 5px #ccc;
	box-shadow: 1px 1px 5px #ccc;
    }
    .attach {
	justify-content: center;
	position: absolute;
	display: flex;
	height: 3em;
	width: 100%;
	z-index: 1;
	top: -3em;
    }
    .category {
	display: inline-block;
	text-align: center;
	padding-top: 2.2em;
	cursor: pointer;
	font-size: 8px;
	height: 3.6em;
	width: 18%;
	color: #555;
	z-index: 2;
    }
    .output {
	-ms-overflow-style: -ms-autohiding-scrollbar;
	-webkit-overflow-scrolling: touch;
	height: calc(100% + 1.95em);
	outline: none !important;
	-ms-overflow-style: none;
	position: absolute;
	overflow-x: hidden;
	padding-right: 7%;
	padding-left: 7%;
	overflow: auto;
    }
    .set {
	font-size: 10px;
	cursor: pointer;
	padding: 2.5em;
    }
    .end {
	padding-right: 1.5em;
	margin-bottom: 3em;
	margin-right: auto;
	cursor: pointer;
	display: table;
	width: 100%;
    }
    .pub {
	text-transform: capitalize;
	letter-spacing: 1px;
	font-family: Arial;
	font-weight: bold;
	font-size: 15px;
	width: 100%;
    }
    .ago {
	margin-bottom: 2px;
	margin-top: -3px;
	font-size: 10px;
	color: #888;
    }
    .yt {
	-webkit-overflow-scrolling: touch;
	padding-bottom: 54.25%;
	position: relative;
	width: 100%;
	height: 0;
    }
    iframe {
	position: absolute;
	border: none;
	height: 110%;
	width: 109%;
	left: -4.5%;
	top: 0;
    }
    .random, .opposite {
	border-bottom: 1px solid #888;
	padding-top: 2em;
	position: fixed;
	height: 24px;
	width: 24px;
	bottom: 0em;
	z-index: 2;
    }
    .random {
	padding-left: 3em;
	right: 0em;
    }
    .opposite {
	padding-right: 3em;
	left: 0em;
    }
    .gif {
	-webkit-animation: grow 1.7s infinite ease;
	-moz-animation: grow 1.7s infinite ease
	height: 200px;
	width: 200px;
    }
    @-webkit-keyframes spin {
	100% {-webkit-transform: rotate(360deg);}   
	0%  {-webkit-transform: rotate(0deg);}
    }
    @-moz-keyframes spin {
	100% {-webkit-transform: rotate(360deg);}   
	0%  {-webkit-transform: rotate(0deg);}
    }
    @-webkit-keyframes grow {
	from { -webkit-transform:scale(1) }
	to { -webkit-transform:scale(1.5) }
    }
    @-moz-keyframes grow {
	from { -webkit-transform:scale(1) }
	to { -webkit-transform:scale(1.5) }
    }
    .agent {
	padding-top: 2em;
	height: 120px;
	width: 130px;
    }
</style>
<body>
<div class='wrapper'>
<div class='container'>
	<div class='attach'>
		<div id='News' class='category'>NEWS</div>
		<div id='Media' class='category'>MEDIA</div>
		<div id='Social' class='category'>SOCIAL</div>
		<div id='Sport' class='category'>SPORT</div>
		<div id='Technology' class='category'>TECH</div>
		<div id='World' class='category'>WORLD</div>
		<div id='Youtube' class='category'>YT</div>
	</div>
		<div class='output'></div>
	<div class='ico'>
		<img id='fav' class='fav' src='favicon/favico.png'>
		<img id='inv' class='fav' src='favicon/invert.png'>
	</div>
		<div class='random'></div>
		<div class='opposite'></div>
</div>
</div>
<script>
var op = 0
var request
var ost = 0
var his = 0
var evt = false
var job = false
var sel = 'Social'

if (location.href.match('\\?op=1')){

        app(1)

}

else app(op)

pop(sel)
air(sel)
scr('.pop:last')
$('#'+sel).css({'border-bottom':'1px solid #ccc','color':'#aaa'})

$('.random').on('touchstart click', function(e) {

	ran(sel)

    e.preventDefault()

})

$('.opposite').on('touchstart click', function(e) {

	app('op')

    e.preventDefault()

})

$('.category').on('touchstart click', function(e){

	his = 0
	$('.pop, .air, .arm, .get').remove()
	$('.category').css('border-bottom','none')
	$('.category').css('color','#555')
	$(this).css({'border-bottom':'1px solid #ccc','color':'#aaa'})
	air($(this).attr('id'))
	pop($(this).attr('id'))
	scr('.pop:last')

    e.preventDefault()

})

$('.fav').on('touchstart click', function(e){

	evt = true
	air(sel)
	pop(sel)
	scr('.pop:last')
	setTimeout(function(){ evt = false }, 250)
    e.preventDefault()
    e.stopPropagation()

})

$('#inv').on('touchstart click mousemove mouseleave', function(e){

    if (e.type == 'mousemove') $(this).css({'-moz-box-shadow':'2px 2px 5px #aaa','box-shadow':'2px 2px 5px #aaa'})
    else if (e.type == 'mouseleave') $(this).css({'-moz-box-shadow':'2px 2px 5px #ccc','box-shadow':'2px 2px 5px #ccc'})

})

$('.output').on('scroll touchmove focusout', function(e){

    if (e.type == 'scroll' || e.type == 'touchmove'){

	pin($(this).scrollTop())
	if ($(this).scrollTop() != 0 && $(this).scrollTop() != $('air').outerHeight()){ job = false }
	if ($(this).scrollTop() + $(this).innerHeight() >= $(this)[0].scrollHeight - 1) if (job == false) pop(sel)

    }
    else if (e.type == 'focusout') setTimeout(function(){ $('.output').focus() }, 100)

}).attr('tabindex', -1).focus()


String.prototype.trunc =

     function(n, e){
         if (this.length <= n) return this
         var subString = this.substr(0, n-1)
         return ( e ? subString.substr(0, subString.lastIndexOf(' ')) : subString) + "&hellip;"
      }

function abr(n, e) {

	e = Math.pow(10,e);
	var a = [ "k", "m", "b", "t" ]

	for (var i=a.length-1; i>=0; i--) {
		var size = Math.pow(10,(i+1)*3)
		if(size <= n) {
			n = Math.round(n*e/size)/e
			if((n == 1000) && (i < a.length - 1)) {
				n = 1
				i++
			}
			n += a[i]
		}
	}

	return n

}

function scr(n){ $('.output').animate({ scrollTop: $(n+':last').offset().top - $('.output').offset().top + $('.output').scrollTop() }, 100) }

function pin(n){

	if (job == true){ $('.fav').css({'transition':'.2s','top':'0px'}); $('.attach').css({'transition':'.5s','top':'0em'}) }
	else if (evt == true){ $('.fav').css({'transition':'.5s','top':'75px'}); $('.attach').css({'transition':'.2s','top':'-3em'})}

	if (n < ost - 5 && evt == false){ $('.fav').css({'transition':'.2s','top':'0px'}); $('.attach').css({'transition':'.5s','top':'0em'}) }
	else if (n > ost + 5 && job == false){ $('.fav').css({'transition':'.5s','top':'75px'}); $('.attach').css({'transition':'.2s','top':'-3em'}) }

    ost = n

}

function ran(n){

	var obj = []
	$.each(menu, function(i,k){ if (n == k.cat) obj.push(menu[i]) })
	var n = obj[Math.floor(Math.random()*obj.length)]
	get(menu.indexOf(n))

}

function rev(Object) {

	var newObject = {}
	var keys = []
	for (var key in Object) keys.push(key)
	for (var i = keys.length - 1; i >= 0; i--) {

		var value = Object[keys[i]]
		newObject[keys[i]] = value

	}

   return newObject

}

function utc(n){

	var opt = { weekday : 'short', day : '2-digit', month : 'short', year : 'numeric', hour : 'numeric', minute : 'numeric' , second : '2-digit', hour12 : true }
	var dmz = []
	dmz.push(ago(n))
	var utc = new Date(n)
	var gmt = utc.toLocaleString('en-US', opt)
	dmz.push(gmt)

    return dmz

}

function ago(n){

	var age = new Date()
	var dis = age.getTime() - new Date(n).getTime()
	var sec = dis/1000
	if (sec < 60) return parseInt(sec) + ' second' + (parseInt(sec) > 1 ? 's' : '') + ' ago'
	var min = sec/60; if (min < 60) return parseInt(min) + ' minute' + (parseInt(min) > 1 ? 's' : '') + ' ago'
	var h = min/60; if (h < 24) return parseInt(h) + ' hour' + (parseInt(h) > 1 ? 's' : '') + ' ago'
	var d = h/24; if (d < 30) return parseInt(d) + ' day' + (parseInt(d) > 1 ? 's' : '') + ' ago'
	var m = d/30; if (m < 12) return parseInt(m) + ' month' + (parseInt(m) > 1 ? 's' : '') + ' ago'
	var y = m/121

    return parseInt(y) + ' year' + (parseInt(y) > 1 ? 's' : '') + ' ago'

}

function app(n){

	if (n == 'op'){ op = op != true } else if (n == 1 || n == 0) op = n

	if (op == 1){

		$('html, .container, .output').css({'background-color':'#000','color':'#EEE'})
		$('hr').css('visibility','hidden'); $('#inv').hide(); $('#fav').show()
		$('.attach').css('background-color','rgba(0, 0, 0, .7)')
		$('.output').removeClass('invert').addClass('default')
		$('.gif, .agent').attr('src','favicon/favico.png')
		$('.img').css('filter','brightness(50%)')

	}

	else if (op == 0){
		$('.container, .output').css({'background-color': '#fff','color':'#333'})
		$('hr').css('visibility','visible'); $('#fav').hide(); $('#inv').show()
		$('.attach').css('background-color','rgba(255, 255, 255, .9)')
		$('.output').removeClass('default').addClass('invert')
		$('.gif, .agent').attr('src','favicon/invert.png')
		$('html').css('background-color','#FAFAFA')
		$('.img').css('filter','brightness(100%)')

	}
	
}

function air(n){

	rev(menu.reverse())
	$('.output').prepend("<div class='air'></div>")
	for (var i = menu.reverse().length - 1; i >= 0; i--){ if (n == menu[i].cat) $('.air').prepend("<hr class='br'><div class='set' onclick='get(" + i + ")'>" + menu[i].des + "</div>") }
	$('.output').scrollTop($('.output').scrollTop() + $('.air:first').outerHeight())
	app()

}

function pop(n){

	if (job == true){ request.abort(); job = false }
	if ($('.pop, .air').length > 2){ $('.pop, .air:last, .get').remove() }
	document.title = n + ' ack'
	if (n != sel) his = 0
	sel = n
	$('.output').append("<div class='pop'></div>")
	for (var i = his; i < menu.length; i++) if (n == menu[i].cat) $('.pop').append("<hr class='br'><div class='set' onclick='get(" + i + ")'>" + menu[i].des + "</div>")
	his = 0
	app()

}


function res(i, n) {

	var e = new Image()
	e.onload = function() {

		if (e.width > 320) $('#'+i).width('100%')
		$('#'+i).css('visibility','visible')

	}

    e.src = n

}

function get(n){
	if (job == true){ request.abort(); job = false }
	his = n
	job = true
	$('.pop, .air, .arm, .get').remove()
	if (sel == 'Youtube'){ var quit = 6 } else { var quit = 11 }
	$('.output').append("<div class='arm'></div><div class='get'></div>")
	if ($('.output').hasClass('invert')){ gif = 'invert.png' } else { gif = 'favico.png' }
	$('.arm').html("<br><div style='display:inline-block'><img class='gif' src='favicon/" + gif + "'></div>")
	request = $.get('https://acktic-github-io.herokuapp.com/' + menu[n].uri)
		.fail(function(){ $('.arm').remove(); air(sel); pop(sel); job = false })
		.done(function(data){
			$('.arm').remove()
			$('.get').append("<hr><div class='set' onclick='window.open(\""+menu[n].ext+"\")' style='margin-bottom:2em'>"+menu[n].des+"</div><br>")
			if ($(data).find('entry').length > 0)				     var chn = "entry"
			else 								     var chn = 'item'
				$(data).find(chn).each(function(i){
					if (chn == 'entry'){
											     var ref = $(this).find('link').attr('href')
											     var dst = utc($(this).find('updated').text())
					}
					else {
											     var ref = $(this).find('link').text()
						if ($(this).find('pubDate').text().length>0) var dst = utc($(this).find('pubDate').text())
											else var dst = utc($(this).find('dc\\:date, date').text())
					}						/* Reddit thumbnails */
											     if (img = $(this).find('content').text()){
											     if (img = img.match(/https:\/\/.\.thumbs\.redditmedia\.com\/.+?(png|jpg)/g)) img = "<img id='" + i + "' src='" + img + "' class='img'>"
										       }
											/* Standard thumbnails */
											else if (img = $(this).find('link').attr('href')){
								     if (img.match(/youtube/)){
												 img = "<div class='ago'><b>Views</b> " + abr($(this).find('media\\:statistics, statistics').attr('views'), 2) + "</div>" +
												       "<div class='yt'><iframe src='https://www.youtube.com/embed/" + img.split('=')[1] + "' allowfullscreen='allowfullscreen'></iframe></div>"
											      }
											    else img = "<img src='"+img+"' class='img'><br>"
										        }
											/*  Media Thumbnails */
										        else if (img = $(this).find('media\\:thumbnail, thumbnail, media\\:content, content').attr('url')) img = "<img id='" + i + "' src='" + img + "' class='img' style='visibility:hidden'>"

											/* Description thumbnails */
										        else if (img = $(this).find('description').text()){
											     if (img = img.match(/src=['"](.*?)['"]/)) if(img[1].match(/assets|feedburner|feedblitz/)) img = null
																       else img = "<img id='" + i + "' src='" + img[1] + "' class='img' style='visibility:hidden'>"
												}
					if (!img || menu[n].des.match(/Slashdot/)) img = "<img class='agent' src='favicon/" + gif + "'>"

					if (i < quit) $('.get').append( "<div class='end' onclick='window.open(\"" + ref.trim() + "\")'><div class='pub'>" + $(this).find('title:first').text().trim().trunc(90, true) + "</div><div class='ago'>" + dst[0] + " " + dst[1] + "</div>" + img + "</div>")

					if ($('#'+i).length) res(i, $('#'+i).attr('src'))

					if (i >= quit){ app(op) }
				})
			air(sel)
		})
}
</script>
</body>
</html>
