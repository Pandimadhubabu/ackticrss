<!DOCTYPE HTML>
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta name="viewport" content="initial-scale=1.0, maximum-scale=1.0,user-scalable=no" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <link rel="shortcut icon" type="image/ico" href="favicon.ico">
    <script src="https://code.jquery.com/jquery-1.7.1.min.js"></script>
    <script src="https://acktic.github.io/rss.js"></script>
  </head>
<body>
<style>
	::-webkit-scrollbar {
		display: none;
	}
	div, .ran, .xml {
		font-family: -apple-system,BlinkMacSystemFont,Segoe UI,Helvetica,Arial,sans-serif,Apple Color Emoji,Segoe UI Emoji;
		font-size: 12px;
		cursor: default;
		border: none;
	}
	.con {
		position: absolute;
		height: 100%;
		width: 99%;
		left: 1px;
		top: 0em;
	}
	.tag {
		justify-content: center;
		display: flex;
	}
	.cat {
		display: inline-block;
		padding-bottom: 1.5em;
		padding-top: 1.5em;
		text-align: center;
		font-size: 12px;
		padding-left: 1;
		width: 16.3%;
	}
	.out {
		outline: none !important;
		position: absolute;
		overflow: auto;
		bottom: 3em;
		width: 98%;
		left: 4px;
		top: 4em;
	}
	.xml {
		padding-bottom: 3em;
		padding-left: 2px;
		padding-top: 3em;
		width: 98%;
	}
	.bar {
		margin-bottom: 8em;
		margin-top: 6em;
		padding: 6em;
	}
	.bot {
		position: absolute;
		text-align: center;
		height: 1.5em;
		bottom: 0em;
		width: 100%;
	}
</style>
    <div class="con">
	<div class="tag">
		<div id="Local" class="cat" onclick="$(this).pop($(this).attr('id'))">Local</div>
		<div id="Entertainment" class="cat" onclick="$(this).pop($(this).attr('id'))">Ent</div>
		<div id="Social" class="cat" onclick="$(this).pop($(this).attr('id'))">Social</div>
		<div id="Sports" class="cat" onclick="$(this).pop($(this).attr('id'))">Sports</div>
		<div id="Technology" class="cat" onclick="$(this).pop($(this).attr('id'))">Tech</div>
		<div id="World" class="cat" onclick="$(this).pop($(this).attr('id'))">World</div></div>
	<div class="out"></div>
	<div class="bot">
		<div class="toggle" onclick="$(this).app('toggle')"><i class="fa fa-th-large"></i></div>
		<div class="random" onclick="$(this).ran($('.sel').attr('id'))"><i class="fa fa-random"></i></div>
		<div class="handler" onclick="$(this).run()"></div>
	</div>
    </div>
<script>
jQuery(function($) {
    $(window).load(function() {
	$(".handler").trigger("click");
	//$(this).app("toggle");  	//Dark Mode
	$(".out").attr('tabindex', -1).focus();
	$(".out").focusout(function(){
		$(".out").attr('tabindex', -1).focus();
	});
    });
    $(document).one("ready", function() {
   	$('.out').bind('scroll', function(){
		if ($(this).scrollTop() + $(this).innerHeight() >= $(this)[0].scrollHeight ) {
			if (!$(".out").hasClass("rss")) {
				$(this).pop($(".sel").attr("id"));
			}
		}
	});
	$.fn.url = function(n) { window.open(n); };
	$.fn.scr = function(n) { $(".out").animate({ scrollTop: $(n + ":last").offset().top - $(".out").offset().top + $(".out").scrollTop() }, 1000); }
	$.fn.pop = function(n) {
		$(".pop, .api, .xml, .bar").remove();
		$(".cat").removeClass("sel");
		$("#" + n).addClass("sel")
		$(".out").append("<div class='pop' style='margin-top:" + $(".out").height() / 100 * 50 + "px'>");
		$(this).scr(".pop");
		$.each(menu, function(i, k) {
			if (n == k.category) {
				$(".out").append("<div id='" + k.name + "' class='api xml' onclick='$(this).xhr($(this).attr(\"id\"))'>&ensp;&ensp;<i class='fa fa-rss'></i>&ensp;&ensp;<b>" + k.category + "</b>&ensp;" + k.title + "</div>");
			}
		});
		$('.out').append("<div class='bar' onclick='$(this).ran($(\".sel\").attr(\"id\"))'><div style='text-align:center;width:100%'>&ensp;&ensp;<b>Random " + $(".sel").attr("id") + "</b></div></div>");
		$(this).app();
	}
	$.fn.xhr = function(n) {
		$.each(menu, function(i, k) {
			if (n == k.name) {
				$(this).get(k.category, k.feed, k.title, k.homepage);
			}
		});
	}
	$.fn.ran = function(n) {
		var obj = [];
		$.each(menu, function(i, k) {
			if (n == k.category) {
				obj.push(menu[i]);
			}
		});
		var n = obj[Math.floor(Math.random()*obj.length)];
		$(this).get(n.category, n.feed, n.title, n.homepage);
	}
	$.fn.run = function(n) {
	if (!window.location.href.match('\\?dark=1')) {
	} else { $(this).app("toggle"); }
	if (    !window.location.href.match('\\&cat=Local') &&
		!window.location.href.match('\\&cat=Entertainment') &&
		!window.location.href.match('\\&cat=Social') &&
		!window.location.href.match('\\&cat=Sports') &&
		!window.location.href.match('\\&cat=Technology') &&
		!window.location.href.match('\\&cat=World') ) {
		$(this).pop("Social"); 
	}
	else {
		$(this).pop(window.location.href.match(/(?<=cat=)(.*?)[^&]+/)[0]);
	}
	return false;
	}

	$.fn.app = function(n) {
		if (n == "toggle") {
			$(".out").toggleClass("dark");
		}
		if (!$(".out").hasClass("dark")) {
			$("body, .con, .cat, .xml").attr("style", "background-color: transparent; color: #000000;");
		}
		else {
			$("body, .con, .cat, .xml").attr("style", "background-color: #000000; color: #FFFFFF;");
		}
		$(".toggle").attr("style", "font-size:16px;position:absolute;left:1em;bottom:-.5em;padding:1em;padding-right:2em");
		$(".random").attr("style", "font-size:16px;position:absolute;right:1em;bottom:-.5em;padding:1em;padding-left:2em");
	}
	$.fn.get = function(category, feed, title, homepage) {
		$(".pop, .bar").remove();
		$(".out").append("<div class='get'><div class='xml'>&ensp;&ensp;It's on the way!&ensp;&ensp;Please be patient.</div></div>")
		$(".out").addClass("rss");
		$(this).scr(".get");
		$.get("https://salty-refuge-64158.herokuapp.com/" + feed)
		.fail(function () {
			$(".out").append("<div class='api'><div class='xml'>Oops! Something went wrong!</div></div>")
			$(".out").removeClass("rss");
		 })
		.success(function (data) {
			var entry = $(data).find("entry");
			if (entry.length > 0) {
				var format = "entry"
			}
			else {
				var format = "item"
			}
			$(".out").append("<div class='get'><div class='xml' onclick='$(this).link(\"" + homepage + "\")'><i class='fa fa-external-link'></i>&ensp;&ensp;<b>" + category + "</b>&ensp;" + title + "</div>");
			$(data).find(format).each(function (i, k) {
				if (format == "entry") {
					var link = $(this).find("link").attr("href");
				}
				else {
					var link = $(this).find("link").text();
				}
				$(".out").append("<div class='xml' onclick='$(this).url(\"" + link + "\")'>&ensp;&ensp;" + $(this).find("title").text() + "</div>");
				if(i >= 24) { return false; }
			});
			$(".out").removeClass("rss");
			$(".out").append("<div class='xml' onclick='$(this).url(\"" + homepage + "\")'><i class='fa fa-external-link'></i>&ensp;&ensp;<b>" + category + "</b>&ensp;" + title + "</div>");
			$('.out').append("<div class='bar' onclick='$(this).ran($(\".sel\").attr(\"id\"))'><div style='text-align:center;width:100%'>&ensp;&ensp;<b>Random " + $(".sel").attr("id") + "</b></div></div>");
			$(this).app();
			$(this).scr(".get");
		})
	}
    });
});
</script>
</body>
</html>
