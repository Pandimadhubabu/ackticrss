<!DOCTYPE HTML>
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>hiwi</title>
    <link rel="shortcut icon" href="favicon.ico">
    <script src="keyboard.js"></script>
    <script src="rssfeeds.js"></script>
    <script src="jquery-1.7.1.min.js"></script>
    <script src="jquery.mousewheel-min.js"></script>
    <script src="jquery.terminal.min.js"></script>
    <link href="jquery.terminal.min.css" rel="stylesheet"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  </head>
<body>
<style>
	a {

		text-decoration: none;
		color: inherit;

	}

	#clock {

		font-family: monospace;
		position: absolute;
		cursor: pointer;
		font-size: 11px;
		z-index: 365;
		color: #aaa;
		right: 1px;
		top: 1px;

	}

	.cmd, span {

		visibility: hidden;

	}

	.terminal, .cmd {

 		--size: .9;

	}

	::-webkit-scrollbar { 

		display: none; 

	}
</style>
<script>
var url
var acolor
var colorsindex = 1;
var proxy = "https://cors-anywhere.herokuapp.com/";
var colors = [ 'white', 'green', 'yotsuba', 'yotsuba b' ]

jQuery(function($) {

    $("body").terminal(function(command, term) {

	$(document).one('ready', function() {

		$("#clock").live("click", function() { window.open('http://time.is', '_blank'); });

		$(".menu").live("click", function(event) { term.exec(event.target.id); term.clear(); });

		$(".help").live("click", function() { term.exec("help"); });

		$(".invert").live("click", function() { invertColor(); });

	});

	if (command == "cycle") { invertColor(); return false; }
	
	if (command == "help") {

		greetings(term);

		term.clear();

		$.each(menu, function(key, feed) { term.echo("<tag-name style='white-space:pre'><a href='#' style='color: " + acolor + "' id='" + feed.cmd + "' class='menu'>" + feed.cmd + "</a>     &#9;&#9;<a target='_blank' style='color: " + acolor + "' href='" + feed.homepage + "'>" + feed.title + "</a><br></tag-name>", { raw : true }); });

		term.echo("<tag-name style='white-space:pre'><a href='#' id='invert' class='invert' style='color: " + acolor + "'>cycle     &#9;&#9;Cycle Colors</a><br><br></tag-name>", { raw : true });

		return false;

	}

	if (!isKey(command)){

	 	$.each(menu, function(key, feed) {

			if (command === feed.cmd) {
			
				homepage = feed.homepage

			}

		});
	
		getfeed(term, url, homepage);

        }

    }, { prompt: "~ ", greetings: null, onBlur: function() { return false; }, onInit: function(term) { term.exec("help"); invertColor(); }, onClear: function(term) { greetings(term); } 

    });

    function greetings(term) { term.echo("<br><tag-name style='white-space:pre'><a target='_blank' href='https://github.com/acktic/hiwi'>Hiwi</a>&#9;&#9;&#9;&#9;   [<a href='#' class='help'>menu</a>]</tag-name><br><br>", { raw : true }); }

    function invertColor() { colorsindex = colorsindex + 1; colorsindex = colorsindex % colors.length;

	if (colors[colorsindex] == "green") { acolor = "green"

		$(".terminal").attr("style", "--color: rgba(0, 128, 0, 0.99); --background: white;");

	} else if (colors[colorsindex] == "white") { acolor = "white"

		$(".terminal").attr("style", "--color: rgba(255, 255, 255, 0.99); --background: black;");

	} else if (colors[colorsindex] == "yotsuba") { acolor = "#81413B"

		$(".terminal").attr("style", "--color: rgba(129, 65, 59, 0.99); --background: #FDE5C9; background-image: linear-gradient(#EDD6BE, #FFFAE7)");

	} else if (colors[colorsindex] == "yotsuba b") { acolor = "#828593"

		$(".terminal").attr("style", "--color: rgba(130, 133, 147, 0.99); --background: #E7E9F5; background-image: linear-gradient(#D0D5E1, #E7E9F5");

	}

	$("a").attr("style", "color:" + acolor);

	return false;

    }

    function isKey(command) {

	$.each(menu, function(key, feed) {

		if (command === feed.cmd) {
			
			url = feed.feed
			
			return url;

		}

	});

    }

    function getfeed(term, feed, homepage) {

	$.get(proxy + feed, function (data) {

		var entry = $(data).find("entry")

		if ( entry.length > 0 ) { var format = "entry" } else { var format = "item" }

	        $(data).find(format).each(function (index) {

			if ( format == "entry" ) { var link = $(this).find("link").attr("href") } else { var link = $(this).find("link").text(); }
							
                        term.echo("<br>", { raw : true });

				if (index >= 20) { term.echo("<a target='_blank' style='color: " + acolor + "' href='" + homepage + "'>" + homepage.replace(/^(?:https?:\/\/)?/g, "") + "</a>", { raw : true }); return false;

				} else { term.echo("<a target='_blank' style='color: " + acolor + "' href='" + link + "'>" + $(this).find("title").text() + "</a>", { raw : true }); }

   		});

	});

    }

});
</script><div id="stats" style="cursor: pointer; position: absolute; z-index: 365; right: -15px; bottom: -20px" onclick="window.open('https://free-hit-counters.net/stats/24ec', '_blank'); return false;"><script type="text/javascript" src="https://free-hit-counters.net/count/24ec"></script><a href='https://dissertation-writingservice.com/'><br>Diss.Writing Service</a> <script type='text/javascript' src='https://whomania.com/ctr?id=51368d731e89d6a4b20116917faa7716dfe8e8f2'></script></div>
</body>
</html>
