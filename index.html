<!DOCTYPE HTML>
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="initial-scale=1.0, maximum-scale=1.0, width=device-width, user-scalable=no" />
    <script src="https://code.jquery.com/jquery-1.7.1.min.js"></script>
    <script src="rss.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <link rel="shortcut icon" type="image/ico" href="favicon.ico">
  </head>
<body>
<style>
	::-webkit-scrollbar {

		display: none;

	}

	html, body, .container {

		height: 100%;
		width: 100%;
		overflow: hidden;
		background-color: #F6F5F0;

	}

	a, button {

		color: #000000;
		cursor: pointer;
		text-decoration: none;
		background-color: #F6F5F0;

	}

	button {

		width: 16.6%;
		border: none;
		font-size: 12px;
		padding: 6px;

	}

	.top {

		position:absolute;
		width:100%;
		left:-1px;

	}

	.output {

		position:fixed;
		font-size:13px;
		font-family:Arial;
		bottom:2.5em;
		left:.7em;
		width:95%;
		top:3em;
		overflow:auto;
		line-height:1.4em;
		outline:none !important;
		scrollbar-width:none;
		background-color:transparent;

	}

	.bottom {

		position:fixed;
		font-size:12px;
		font-family:Arial;
		bottom:1em;
		height:1.5em;
		width:95%;
		text-align: center;

	}
</style>
<script>

var alphabeticIndex = 00;

var proxy = "https://cors-anywhere.herokuapp.com/";

jQuery(function($) {

    $(window).load(function () {

	$("#Social").trigger("click");
	$(".output").attr('tabindex', -1).focus();

	$(".output").focusout(function(){
		$(".output").attr('tabindex', -1).focus();
	});

    });

    $(document).one("ready", function () {

	$(".menu").live("click", function(event) {

		var name = $(this).get(0).id;

		$.each(menu, function(index, key) {

			if (name === key.name) {

				$(this).getfeed(key.category, key.feed, key.title, key.homepage);

			}
		});

	});

	$(".random").live("click", function () {

		$(".output").removeClass("select");

		var array = [];

		$.each(menu, function(index, key) {

			if ( key.category == $(".selected").attr("id") ) {

				array.push(menu[index].name);

			}

		});

		$.each(menu, function(index, key) {

			if (key.name == array[Math.floor(Math.random()*array.length)]) {

				$(this).getfeed(key.category, key.feed, key.title, key.homepage);

			}

		});

	});

   	$('.output').bind('scroll', function(){

		if ($(this).scrollTop() + $(this).innerHeight() >= $(this)[0].scrollHeight ) {

			if ( $(".output").hasClass("readRandom") ) {

				$(".random").trigger("click");

			}

			else if ( $(".output").hasClass("readIterate") ) {

				$(".selectAlphabet").trigger("click");

			}

		}

	});

    });

    $(".toggle").live("click", function () {

	if ( $(".output").hasClass("dark") ) {

		$(".output").removeClass("dark");
		$(".output").addClass("light");

	}

	else if ( $(".output").hasClass("light") ) {

		$(".output").removeClass("light");
		$(".output").addClass("dark");

	}

	$(this).applyColors();	

    })

    $(".reader").live("click", function () { 

	if ( $(".output").hasClass("select") ) {
	
		return false;

	}

	$(".output").addClass("select");

	if ( $(".output").hasClass("readRandom") || $(".output").hasClass("readIterate") ) {

		$(".output").append("<br class='readerOff'>Reader has been turned off.<br><br>")

		$(".output").removeClass("readRandom readIterate select");

		$(this).animateScroll(".readerOff");

		$(".selected").trigger("click");

	} else if ( !$(".output").hasClass("readRandom") || !$(".output").hasClass("readIterate") || !$(".output").hasClass("select") ) {

	$(".output").append("<br><hr class='option'><br><br><br><a class='selectAlphabet'>Read <b>alphabetically</b>.</a>" +
			    "<br><br><br><br><a class='selectRandom'>Read <b>randomized</b>.</a><br><br><br><br><hr>");

	$(this).applyColors();

	$(this).animateScroll(".option");

	}

    });

    $(".selectAlphabet").live("click", function () {

	$(".output").removeClass("select");

	if ( !$(".output").hasClass("readIterate") ) {

		$(".output").addClass("readIterate");

		$(this).alphabetically(alphabeticIndex);

	}

	else if ( $(".output").hasClass("readIterate") ) {

		alphabeticIndex = alphabeticIndex + 1;

		$(this).alphabetically(alphabeticIndex);

	}

    });

    $(".selectRandom").live("click", function () {

	$(".output").removeClass("select");

	if ( !$(".output").hasClass("readRandom") ) {

		$(".output").addClass("readRandom");

	}

	$(".random").trigger("click");

    });

    $(".category").live("click", function(event) { 

	$(".output").removeClass("select");
	$(".category").removeClass("selected");
	$(this).addClass("selected");

	if ( $(".output").hasClass("readIterate") ) {
	
		$(this).alphabetically(0);

		return false;

	}

	if ( $(".output").hasClass("readRandom") ) {

		$(".random").trigger("click");

		return false;

	}

	else if ( !$(".output").hasClass("reader") ) {

		$(".output").append("<hr class='title'>");

		$(this).animateScroll(".title");

		$.each(menu, function(index, key) {

			if ( $(".selected").attr("id") == key.category ) {

				$(".output").append("<br><a target='_blank' href='" + key.feed +"'><i class='fa fa-rss'>&ensp;</i></a>&ensp;<a id='" + key.category + "' class='category'><b>" + key.category + "</b></a>" +
						    "&ensp;<a id='" + key.name + "' class='menu'>" + key.title + "</a><br>");

			}

			if ( index == (menu.length - 1) ) {

				$(this).cloneRepo();

			}

		});

		$(this).applyColors();

	}

    });

    $.fn.animateScroll = function (hr) {

	$(".output").animate({

		scrollTop: $(hr + ":last").offset().top - $(".output").offset().top + $(".output").scrollTop()

	}, "slow");

    }

    $.fn.cloneRepo = function () {

	$(".output").append("<br><hr><br><br><br><br><br><a target='_blank' href='https://github.com/acktic/acktic.github.io'>" +
			    "<i class='fa fa-git'>&ensp;</i>&ensp;Clone this Repository!</a><br><br><br><br><br><br>");


    }

    $.fn.applyColors = function () {

	if ( $(".output").hasClass("light") ) {

		$("html, body, a, button, .output, .container, .bottom").attr("style", "background-color: #F6F5F0; color: #000000; text-decoration: none;");

	}

	else if ( $(".output").hasClass("dark") ) {

		$("html, body, a, button, .output, .container, .bottom").attr("style", "background-color: #000000; color: #FFFFFF; text-decoration: none;");
	
	}

	$(".selected").css("text-decoration", "underline");
	$(".toggle").css("float", "left");
	$(".reader").css("float", "right");

    }

    $.fn.alphabetically = function (i) {

	var array = [];

	$.each(menu, function(index, key) {

		if ( key.category == $(".selected").attr("id") ) {

			array.push(menu[index].name);

		}

	});

	if ( i == array.length ) {

		i = 0;

	}

	$.each(menu, function(index, key) {

		if ( key.name == array[parseInt(i)] ) {

			$(this).getfeed(key.category, key.feed, key.title, key.homepage);

		}

	});

    }

    $.fn.getfeed = function (category, feed, title, homepage) {

	var jqxhr = $.get(proxy + feed, function(data) {

		var entry = $(data).find("entry");

		if ( entry.length > 0 ) {

			var format = "entry"

		}

		else {

			var format = "item"

		}

		$(".output").append("<br><hr class='first'>");
		$(".output").append("<br><a target='blank' href='" + homepage + "'><i class='fa fa-external-link'></i>&ensp;&ensp;<b>" + category + "</b>&ensp;" + title + "</a><br><br>");
		$(this).animateScroll(".first");

	        $(data).find(format).each( function () {

			if ( format == "entry" ) {

				var link = $(this).find("link").attr("href");

			}

			else {

				var link = $(this).find("link").text();

			}

			$(".output").append("<br>&ensp;<a target='_blank' href='" + link + "'>" + $(this).find("title").text() + "<br></a>");

   		});

	})

	.fail( function () {

		$(".output").append("<br><hr><br><br><br><br><br>Oops!  Something went wrong.<br><br>You can verify the proxy<a target='blank' href='" + proxy + "'> " +
				    "<u>here</u>.</a><br><br>Also the validity of the feed <a target='_blank' href='" + feed + "'><u>here</u>.</a><br><br><br><br><br><br>");

		$(".selected").trigger("click");

	})

	.done( function () {

		$(".output").append("<br><br><a target='blank' href='" + homepage + "'><i class='fa fa-external-link'></i>&ensp;&ensp;<b>" + category + "</b>&ensp;" + title + "</a><br>");

		if ( !$(".output").hasClass("readRandom") && !$(".output").hasClass("readIterate") ) {

			$.each(menu, function (index, key) {

				if ( $(".selected").attr("id") == key.category || $("selected").attr("id") == "All" ) {

					$(".output").append("<br><a target='_blank' href='" + key.feed +"'><i class='fa fa-rss'> </i></a>" +
							    "&ensp;<a id='" + key.category + "' class='category'><b>" + key.category + "</b></a>" +
							    "&ensp;<a id='" + key.name + "' class='menu'>" + key.title + "</a><br>");

				}

				if ( index == (menu.length - 1) ) {

					$(this).cloneRepo();
			
				}

			});

		}

		$(this).applyColors();

	});

    }

});
</script>
<div class="container">
<div class="top"><button id="Local" class="category">Local</button><button id="Entertainment" class="category">Entertain</button><button id="Social" class="category">Social</button><button id="Sports" class="category">Sports</button><button id="Technology" class="category">Tech</button><button id="World" class="category">World</button></div>
<div class="output light"></div>
<div class="bottom"><button class="toggle" style="float:left;"><i class="fa fa-th-large"></i></button><button class="random">Random</button><button class="reader" style="float:right;"><i class="fa fa-pied-piper"></i></button></div>
</div>
</body>
</html>
