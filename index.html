<!DOCTYPE HTML>
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta name="viewport" content="initial-scale=1.0, maximum-scale=1.0,user-scalable=no">
    <link href="https://fonts.googleapis.com/css?family=Roboto&display=swap" rel="stylesheet">
    <script src="https://code.jquery.com/jquery-1.7.1.min.js"></script>
    <script src="https://acktic.github.io/rss.js"></script>
    <link rel="icon" type="image/png" href="favicon.png">
  </head>
<body>
<style>
	::-webkit-scrollbar { display: none }
	div {
		-webkit-font-smoothing: antialiased;
		-moz-osx-font-smoothing: grayscale;
		font-family: 'Roboto', sans-serif;;
		font-size: 12px;
		cursor: default;
	}
	.cat {
		font-family: 'Roboto', sans-serif;
		background-color: inherit;
		display: inline-block;
		padding-bottom: 2em;
		text-align: center;
		padding-top: 2em;
		font-size: 14px;
		color: inherit;
		width: 16.3%;
	}
	.xml {
		background-color: inherit;
		padding-bottom: 2em;
		line-height: 1.2em;
		width: fit-content;
		padding-left: 1em;
		padding-top: 1em;
		color: inherit;
	}
</style>
    <div class="con" style="position:absolute;height:99%;width:96%;top:-.5em">
	<div class="tag" style="justify-content:center;display:flex;height:4.5em">
		<div id="News" class="cat" onclick="pop('News')">News</div>
		<div id="Style" class="cat" onclick="pop('Style')">Style</div>
		<div id="Social" class="cat" onclick="pop('Social')">Social</div>
		<div id="Sports" class="cat" onclick="pop('Sports')">Sports</div>
		<div id="Technology" class="cat" onclick="pop('Technology')">Tech</div>
		<div id="World" class="cat" onclick="pop('World')">World</div>
	</div>
		<img class="fav" style="transform:translateX(50%);position:absolute;bottom:-.7em;height:32px;width:32px;right:50%" src="favicon.png">
	<div class="out" style="webkit-overflow-scrolling:touch;outline:none!important;position:absolute;overflow:auto;height:90%"><div>
    </div>
<script>
var bar=2
var obj=[]
var tap=false
var rss=false
var sel="News"
var dark=false
	$(document).one("ready", function() {
		pop(sel)
		$(".out").css("top", $(".tag").height()+"px");
		if (location.href.match('\\?dark=0')) app(false)
		if (location.href.match('\\?dark=1')) app(true)
		if (location.href.match('\\&cat=News')) pop("News")
 		if (location.href.match('\\&cat=Style')) pop("Style")
		if (location.href.match('\\&cat=Social')) pop("Social")
		if (location.href.match('\\&cat=Sports')) pop("Sports")
		if (location.href.match('\\&cat=Technology')) pop("Technology")
		if (location.href.match('\\&cat=World')) pop("World")
		$(".out").attr('tabindex', -1).focus();
		$(".out").focusout(function(){ $(".out").attr('tabindex', -1).focus()})
   		$('.out').on('scroll', function(){
			if ($(this).scrollTop()+$(this).innerHeight()>=$(this)[0].scrollHeight){
				if (rss==false) pop(sel)
			}
			if ($(this).scrollTop()<1) scr(".pop")
		})
		$(".fav").on("touchstart click",function(e){
			if(!tap){ tap=setTimeout(function(){ tap=null;pop(sel)},300)}
			else { clearTimeout(tap);tap=null;ran(sel) }
		    e.preventDefault()
		});
	});
	function url(n){ window.open(n)}
	function xhr(n){ $.each(menu, function(i, k){ if (n==k.cli) get(k.ver,k.sub,k.api,k.ext)})}
	function scr(n){ $(".out").animate({ scrollTop: $(n+":last").offset().top-$(".out").offset().top+$(".out").scrollTop() }, 200)}
	function ran(n){
		$.each(menu, function(i, k){ if (n==k.ver) obj.push(menu[i])})
		var n = obj[Math.floor(Math.random()*obj.length)]
		get(n.ver,n.sub,n.api,n.ext)
	}
	function app(n){
		if (n==true||n==false) dark=n
		if (n=="toggle") dark=dark!=true
		if (dark==false) $("body").attr("style","background-color:transparent;color:#000000")
		else if (dark==true) $("body").attr("style","background-color:#000000;color:#FFFFFF")
	}
	function pop(n){ sel=n
		$(document).attr("title",n+" - ack")
		$(".pop, .bar").remove()
		$('.out').append("<div class='bar' style='padding-top:"+$(".out").height()/100*bar+"em' onclick='app(\"toggle\")'></div><div class='pop'></div>")
		scr(".pop")
		$.each(menu, function(i, k){ if (n == k.ver) $(".pop").append("<div id='"+k.cli+"' class='xml' onclick='xhr($(this).attr(\"id\"))'><b>"+k.ver+"</b> "+k.sub+"</div>")})
		$('.out').append("<div class='bar' style='padding-bottom:"+$(".out").height()/100*bar+"em' onclick='app(\"toggle\")'></div>")
		app()
	}
	function get(ver,sub,api,ext){ rss=true
		$(".bar:last").remove()
		$(".out").append("<div class='get'><div class='xml'>It's on the way! &ensp;Please be patient.</div></div>")
		scr(".get")
		$.get("https://salty-refuge-64158.herokuapp.com/"+api)
		.fail(function(){ $(".out").append("<div class='get'><div class='xml'><div class='xml'>&ensp;&ensp;Oops! Something went wrong!</div>")})
		.success(function(data){
			var entry = $(data).find("entry")
			if (entry.length > 0) var format = "entry"
			else var format = "item"
			$(".out").append("<div class='get'><div class='xml' onclick='url(\""+ext+"\")'><b>"+ver+"</b>&ensp;"+sub+"</div>")
			$(data).find(format).each(function (i, k){
				if (format == "entry") {
					var link = $(this).find("link").attr("href")
					var date = $(this).find("updated").text()
				}
				else {
					var link = $(this).find("link").text();
					var date = $(this).find("pubDate").text()
				}
				$(".out").append("<div class='xml' onclick='url(\""+link+"\")'>&ensp;"+$(this).find("title").text()+"<br>-"+date+"</div>");
				if(i >= 24) return false
			})
			rss = false
			$(".out").append("<div class='xml' onclick='url(\""+ext+"\")'><b>"+ver+"</b>&ensp;"+sub+"</div>" +
					 "<div class='bar' onclick='app(\"toggle\")' style='padding-bottom:"+$(".out").height()/100*bar+"em'></div>")
			app()
			scr(".get")
		})
	}
</script>
</body>
</html>
