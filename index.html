<!DOCTYPE HTML>
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="initial-scale=1.0, maximum-scale=1.0, width=device-width, user-scalable=no" />
    <script src="https://code.jquery.com/jquery-1.7.1.min.js"></script>
    <script src="feeds.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <link rel="shortcut icon" type="image/ico" href="favicon.ico">
  </head>
<body>
<style>
	::-webkit-scrollbar { display: none; }

	html, body {

		height: 100%;
		width: 100%;
		overflow: hidden;
		background-color: #F6F5F0;

	}

	a, button {

		color: #000000;
		cursor: pointer;
		text-decoration: none;
		background-color: #F6F5F0;

	}

	button {

		width: 13.5%;
		border: none;
		font-size: 16px;
		padding: 8px 0px;

	}

	.output {

		position:fixed;
		font-size:14px;
		font-family:Arial;
		bottom:3em;
		left:.7em;
		width:95%;
		top:3.5em;
		overflow:auto;
		line-height:1.4em;
		outline:none !important;
		scrollbar-width:none;
		background-color:transparent;

	}

	.random {

		position:fixed;
		font-size:16px;
		font-family:Arial;
		bottom:.2em;
		right: 50%;
		transform: translate(50%,-50%);

	}
</style>
<script>

jQuery(function($) {

    $(window).load(function () {

	$("#Social").trigger("click");

	$(".output").attr('tabindex', -1).focus();

	$(".output").focusout(function(){ $(".output").attr('tabindex', -1).focus(); });

    });

    $(document).one('ready', function () {

	$(".menu").live("click", function(event) {

		command = $(this).get(0).id;

		$.each(menu, function(key, index) {

			if (command === index.name) {

				$(this).getfeed(index.feed, index.title, index.homepage);

			}
		});

	});

	$('.output').bind('scroll', function(){ if($(this).scrollTop() + $(this).innerHeight() >= $(this)[0].scrollHeight){ $(".selected").trigger("click"); } });

    });

    $(".back").live("click", function(event) { $(".selected").trigger("click"); });

    $(".category").live("click", function(event) { 

	$(".output").append("<hr class='title'>");

	$(".output").animate({ scrollTop: $(".title:last").offset().top - $(".output").offset().top + $(".output").scrollTop() }, "slow");

	$(".category").removeClass("selected"); $(this).addClass("selected");

	$.each(menu, function(key, index) {

		if ($(".selected").attr("id") == index.category || $(".selected").attr("id") == "All" ) { $(".output").append("<br><a target='_blank' href='" + index.feed +"'><i class='fa fa-rss'>&ensp;</i></a>&ensp;<a id='" + index.category + "' class='category'><b>" + index.category + "</b></a>&ensp;<a id='" + index.name + "' class='menu'>" + index.title + "</a><br>"); }

		if (key == (menu.length - 1)) { $(".output").append("<br><hr><br><br><br><br><br><a target='_blank' href='" + index.homepage + "'><i class='fa fa-external-link'>&ensp;</i>&ensp;" + index.title + "</a><br><br><br><br><br><br><br>"); }

	});

    });

    $(".random").live("click", function () {

	var array = [];

	$.each(menu, function(key, index) { if (index.category == $(".selected").attr("id") || $(".selected").attr("id") == "All") { array.push(menu[key].name); } });

	var feed = array[Math.floor(Math.random()*array.length)];

	$.each(menu, function(key, index) { if (index.name == feed) { $(this).getfeed(index.feed, index.title, index.homepage) } });

    });

    $.fn.getfeed = function (feed, title, homepage) {

	$(".output").append("<br><a target='blank' href='" + homepage + "'><i class='fa fa-external-link'></i>&ensp;<u>" + title + "</u><br></a>");

	$.get("https://cors-anywhere.herokuapp.com/" + feed, function (data) {

		var entry = $(data).find("entry");

		if (entry.length > 0) { var format = "entry" }

		else { var format = "item" }

		$(".output").append("<br><hr class='first'>");

	        $(data).find(format).each(function (index) {

			if (format == "entry") { var link = $(this).find("link").attr("href"); }

			else { var link = $(this).find("link").text(); }

			$(".output").append("<br>&ensp;<a target='_blank' href='" + link + "'>" + $(this).find("title").text() + "<br></a>");

   		});

		$(".output").append("<br><a target='blank' href='" + homepage + "'><i class='fa fa-external-link'></i>&ensp;<u>" + title + "</u><br></a>");

		$(".output").append("<br><hr>");

		$.each(menu, function(key, index) {

			if ($(".selected").attr("id") == index.category || $("selected").attr("id") == "All" ) { $(".output").append("<br><a target='_blank' href='" + index.feed +"'><i class='fa fa-rss'>&ensp;</i></a>&ensp;<a id='" + index.category + "' class='category'><b>" + index.category + "</b></a>&ensp;<a id='" + index.name + "' class='menu'>" + index.title + "</a><br>"); }

			if (key == (menu.length - 1)) { $(".output").append("<br><hr><br><br><br><br><br><a target='_blank' href='" + index.homepage + "'><i class='fa fa-external-link'>&ensp;</i>&ensp;" + index.title + "</a><br><br><br><br><br><br><br>"); $(".output").animate({ scrollTop: $(".first:last").offset().top - $(".output").offset().top + $(".output").scrollTop() }); }

		});

	});

    }

});

</script>
<button id="All" class="category">All</button><button id="Local" class="category">Local</button><button id="Entertainment" class="category">Ent</button><button id="Social" class="category">Soc</button><button id="Sports" class="category">Sport</button><button id="Technology" class="category">Tech</button><button id="World" class="category">World</button><div class="output"></div><a class='random'>Random</a>
</body>
</html>
